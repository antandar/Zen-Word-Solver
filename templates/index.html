<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zen Word Solver</title>

<style>
/* ===== ФОН СТРАНИЦЫ ===== */
body {
    margin: 0;
    font-family: Arial, sans-serif;
    font-size: 18px;
    background: linear-gradient(135deg, #3f5c4d, #6fa18a);
    color: #222;
}

/* ===== КОНТЕЙНЕР ===== */
.container {
    max-width: 480px;
    margin: 20px auto;
    padding: 20px;
    background: rgba(255,255,255,0.93);
    border-radius: 14px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.35);
    box-sizing: border-box;
    overflow-x: hidden; /* защита от горизонтального скролла */
}

/* ===== ЗАГОЛОВКИ ===== */
.subtitle {
    text-align: center;
    font-size: 12px;
    color: #bbb;
    margin-bottom: 4px;
}

h1 {
    text-align: center;
    margin: 0 0 15px;
    color: #2f4f3f;
}

/* ===== ФОРМА ===== */
label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
}

input[type="text"] {
    width: 100%;
    padding: 12px;
    font-size: 20px;
    box-sizing: border-box;
    margin-top: 5px;
    text-transform: uppercase;
}

.checkbox-row {
    margin: 12px 0;
    font-size: 16px;
}

button {
    width: 100%;
    padding: 14px;
    font-size: 18px;
    margin-top: 10px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    color: white;
    background: #4caf50;
}

button.secondary {
    background: #428bfa;
}

/* ===== СПИСОК СЛОВ ===== */
#words {
    margin-top: 15px;
    padding: 10px;
    max-height: 420px;
    overflow-y: auto;
    overflow-x: hidden;

    column-count: 3;
    column-gap: 12px;
}

/* ===== КАРТОЧКИ ===== */
.word-item {
    break-inside: avoid;
    margin-bottom: 8px;
    padding: 10px;
    text-align: center;
    background: #ffffff;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);

    word-break: break-word;
    overflow-wrap: anywhere;
    text-transform: uppercase;
}

.word-item.new {
    background: #fff7a8;
}

/* ===== АДАПТИВ ===== */
@media (max-width: 480px) {
    body { font-size: 20px; }
}
</style>
</head>

<body>
<div class="container">

<div class="subtitle">© designed specifically for "Легенда номер 17" team</div>
<h1>Zen Word Solver</h1>

<label for="letters">Комбинация букв</label>
<input
    type="text"
    id="letters"
    maxlength="7"
    placeholder="Введите буквы"
    autocomplete="off"
    autocorrect="off"
    spellcheck="false"
    autocapitalize="characters"
>

<div class="checkbox-row">
    <label>
        <input type="checkbox" id="hide_3_letters">
        Не показывать слова из 3 букв
    </label>
</div>

<button onclick="solve()">Найти слова</button>
<button class="secondary" onclick="clearWords()">Новая комбинация</button>

<div id="words"></div>

<script>
/* ===== JS ===== */

let previousWords = new Set();

const lettersInput = document.getElementById("letters");
const wordsDiv = document.getElementById("words");
const hide3Checkbox = document.getElementById("hide_3_letters");

/* Только русские буквы + uppercase */
lettersInput.addEventListener("input", () => {
    const pos = lettersInput.selectionStart;
    lettersInput.value = lettersInput.value
        .replace(/[^а-яё]/gi, "")
        .toUpperCase();
    lettersInput.setSelectionRange(pos, pos);
});

/* Enter = поиск */
lettersInput.addEventListener("keydown", e => {
    if (e.key === "Enter") solve();
});

/* Delete = новая комбинация */
document.addEventListener("keydown", e => {
    if (e.key === "Delete") clearWords();
});

/* Автопоиск при переключении чекбокса */
hide3Checkbox.addEventListener("change", () => {
    if (lettersInput.value.trim()) solve();
});

function solve() {
    const letters = lettersInput.value.toLowerCase();
    if (!letters) return;

    const minLength = hide3Checkbox.checked ? 4 : 3;

    fetch("/solve", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ letters, min_length: minLength })
    })
    .then(res => res.json())
    .then(words => {
        wordsDiv.innerHTML = "";

        words.sort((a, b) => a.length - b.length || a.localeCompare(b));

        words.forEach(w => {
            const item = document.createElement("div");
            item.className = "word-item";
            item.textContent = w.toUpperCase();

            if (!previousWords.has(w)) {
                item.classList.add("new");
            }

            item.onclick = () => navigator.clipboard.writeText(w);
            wordsDiv.appendChild(item);
        });

        previousWords = new Set(words);

        /* ЖЕЛЕЗОБЕТОННАЯ автопрокрутка */
        requestAnimationFrame(() => {
            wordsDiv.scrollTop = wordsDiv.scrollHeight;
        });
    });
}

function clearWords() {
    wordsDiv.innerHTML = "";
    lettersInput.value = "";
    previousWords.clear();
    lettersInput.focus();
}
</script>

</div>
</body>
</html>
